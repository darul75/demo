/** 
* @license planetary-twitter - v0.0.1
* (c) 2013 Julien VALERY https://github.com/darul75/ng-prettyjson
* License: MIT 
**/
var stats=function(){return function(a){a.plugins.stats={},a.plugins.redraw=!1,a.onInit(function(b){d3.json("/twitter",function(c,d){if(c)return alert("Problem loading the quake data."),void 0;if(!d||"nok"===d.result)return b(),void 0;var e=d;land=topojson.feature(e,e.objects.collection),a.plugins.stats.topology=land,b()})});var b=[],c=0,d=new Date,e=!1;setInterval(function(){d3.json("/twitter",function(f,g){if(f)return alert("Problem loading the quake data."),void 0;if(g&&"nok"!==g.result){d=new Date,b=[];for(var h=g.objects.collection.geometries.length,i=h-6;h>i;i++)b.push({text:g.objects.collection.geometries[i].properties.text,lat:g.objects.collection.geometries[i].properties.lat,lng:g.objects.collection.geometries[i].properties.lng});e=c!==h,c=h,land=topojson.feature(g,g.objects.collection),a.plugins.stats.topology=land}})},7e3),a.onDraw(function(){a.withSavedContext(function(c){if(a.plugins.stats){c.beginPath(),c.strokeStyle="#FFFFFF",c.globalAlpha=1,c.fillStyle="#FFFFFF",c.font="italic 40pt Calibri",c.fillText("#football",500,500),b.length>0&&(c.font="italic 12pt Calibri",c.fillText(b[0].text,60,300),c.fillText(b[1].text,60,330),c.fillText(b[2].text,60,360),c.fillText(b[3].text,60,590),c.fillText(b[4].text,60,620),c.fillText(b[5].text,60,650)),c.stroke(),c.strokeStyle="white",c.shadowColor="#eeeeee",c.shadowBlur=20,c.shadowOffsetX=5,c.shadowOffsetY=5,c.globalAlpha=.5,a.path.context(c).pointRadius(.001),a.path.context(c)(a.plugins.stats.topology),c.stroke();{170*Math.random()-85,360*Math.random()-180}if(b.length>0&&e){c.strokeStyle="white",c.globalAlpha=.5,c.shadowColor="#eeeeee",c.shadowBlur=20,c.shadowOffsetX=2,c.shadowOffsetY=2,c.globalAlpha=.5;var f=new Date-d,g=1-f/2e3,h=d3.rgb("#FFFFFF");h="rgba("+h.r+","+h.g+","+h.b+","+g+")",c.strokeStyle=h;for(var i=0;i<b.length;i++){var j=8*Math.random(),k=d3.geo.circle().origin([b[i].lng,b[i].lat]).angle(f/2e3*j)();a.path.context(c)(k),c.stroke()}setTimeout(function(){e=!1},2e3)}c.stroke()}})})}};